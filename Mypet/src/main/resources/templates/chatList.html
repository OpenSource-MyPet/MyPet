<!DOCTYPE html>
<html lang="ko" xmlns:th="https://thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>오픈채팅 - MyPet</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/chatList.css">
    <th:block th:replace = "fragment/header :: headerStyle"></th:block>
</head>
<body>
<th:block th:replace = "fragment/header :: header"></th:block>
<!--<div class="header">-->
<!--    <div class="header-top">-->
<!--        <div class="logo">MyPet</div>-->
<!--        <div class="header-nav">-->
<!--            <span class="header-nav-item">홈</span>-->
<!--            <span class="header-nav-item">콘텐츠</span>-->
<!--            <span class="header-nav-item">쇼핑</span>-->
<!--            <span class="header-nav-item active">커뮤니티</span>-->
<!--            <span class="header-nav-item">서비스</span>-->
<!--            <span class="header-nav-item">크리에이터</span>-->
<!--        </div>-->
<!--        <div class="header-actions">-->
<!--            <button class="login-btn">로그인</button>-->
<!--            <span class="menu-icon">☰</span>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<div class="container">
    <!-- 페이지 헤더 -->
    <!-- <div class="page-header">
        <div class="page-title"><i class="fas fa-search"></i> 오픈채팅</div>
        <div class="search-bar">
            <input type="text" class="search-input" placeholder="관심있는 채팅방을 검색해보세요">
            <button class="search-btn"><i class="fas fa-search"></i></button>
        </div>
    </div> -->
    <!-- <div class="page-title">🗨️ 오픈채팅</div>
    <div class="page-subtitle">반려동물 친구들과 함께 이야기를 나눠보세요!</div> -->
    <div class="section-title">
        <i class="fas fa-comments"></i>
        전체 오픈채팅방
    </div>

    <!-- 카테고리 필터 -->
    <div class="category-filter">
        <div class="category-chip active">전체</div>
        <div class="category-chip">🐶 강아지</div>
        <div class="category-chip">🐱 고양이</div>
        <div class="category-chip">🐹 소동물</div>
        <!-- <div class="category-chip">🐦 조류</div>
        <div class="category-chip">🐠 어류</div>
        <div class="category-chip">🦎 파충류</div>
        <div class="category-chip">📍 지역모임</div>
        <div class="category-chip">💊 건강정보</div> -->
        <button class="add-chatroom-btn" onclick="location.href='/addchat'">
            <i class="fas fa-plus"></i> 채팅방 추가
        </button>
    </div>


    <!-- 채팅방 리스트 -->
    <div class="chatroom-list">
        <!-- 채팅방 1 -->
        <div class="chatroom-item" onclick="getChatroom(this)" th:each="chat : ${chatList}" th:attr="data-roomId = ${chat.roomId}">
            <!-- <img src="https://images.unsplash.com/photo-1548199973-03cce0bbc87b?w=300&h=300&fit=crop" class="chatroom-thumbnail" alt="강아지"> -->
            <div class="chatroom-info">
                <div class="chatroom-title" th:text="${chat.title}">
                    서울 강남 반려견 산책 모임
                    <!-- <span class="chatroom-badge">인기</span> -->
                </div>
                <div class="chatroom-description" th:text="${chat.content}">
                    매주 주말 강남 일대에서 반려견과 함께 산책하는 모임입니다. 소형견부터 대형견까지 환영해요!
                </div>
                <div class="chatroom-meta">
                        <span class="chatroom-members popular">
                            <i class="fas fa-user"></i>
                            <span th:text="${chat.user}">1,234명</span>

                        </span>
                    <span>
                            <i class="fas fa-clock"></i>
                            <span th:text="${chat.createdAtFormat}">2025-11-17 13:15</span>
                        </span>
                    <!-- <div class="chatroom-active">
                        <span class="active-dot"></span>
                        <span>활발</span>
                    </div> -->
                </div>
                <div class="chatroom-tags">
                    <span class="tag">#강아지</span>
                    <span class="tag">#산책</span>
                    <span class="tag">#강남</span>
                    <div class="chatroom-active">
                        <span class="active-dot"></span>
                        <span>활발</span>
                    </div>

                </div>

            </div>
        </div>

        <!-- 채팅방 2 -->
<!--        <div class="chatroom-item" onclick="alert('채팅방에 입장합니다!')">-->
<!--            <img src="https://images.unsplash.com/photo-1574071318508-1cdbab80d002?w=300&h=300&fit=crop" class="chatroom-thumbnail" alt="고양이">-->
<!--            <div class="chatroom-info">-->
<!--                <div class="chatroom-title">-->
<!--                    고양이 집사들의 수다방-->
<!--                </div>-->
<!--                <div class="chatroom-description">-->
<!--                    고양이 키우면서 겪는 일상, 정보 공유하는 따뜻한 방입니다. 고양이 사진 환영!-->
<!--                </div>-->
<!--                <div class="chatroom-meta">-->
<!--                        <span class="chatroom-members popular">-->
<!--                            <i class="fas fa-user"></i>-->
<!--                            856명-->
<!--                        </span>-->
<!--                    <span>-->
<!--                            <i class="fas fa-comments"></i>-->
<!--                            활발-->
<!--                        </span>-->
<!--                </div>-->
<!--                <div class="chatroom-tags">-->
<!--                    <span class="tag">#고양이</span>-->
<!--                    <span class="tag">#일상</span>-->
<!--                    <span class="tag">#정보공유</span>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 채팅방 3 &ndash;&gt;-->
<!--        <div class="chatroom-item" onclick="alert('채팅방에 입장합니다!')">-->
<!--            <img src="https://images.unsplash.com/photo-1425082661705-1834bfd09dca?w=300&h=300&fit=crop" class="chatroom-thumbnail" alt="햄스터">-->
<!--            <div class="chatroom-info">-->
<!--                <div class="chatroom-title">-->
<!--                    햄스터 초보 집사 모임-->
<!--                    <span class="chatroom-badge">신규</span>-->
<!--                </div>-->
<!--                <div class="chatroom-description">-->
<!--                    햄스터를 처음 키우시는 분들을 위한 공간입니다. 사육 팁, 건강관리 등 함께 나눠요!-->
<!--                </div>-->
<!--                <div class="chatroom-meta">-->
<!--                        <span class="chatroom-members">-->
<!--                            <i class="fas fa-user"></i>-->
<!--                            124명-->
<!--                        </span>-->
<!--                    <span>-->
<!--                            <i class="fas fa-clock"></i>-->
<!--                            3일 전-->
<!--                        </span>-->
<!--                </div>-->
<!--                <div class="chatroom-tags">-->
<!--                    <span class="tag">#햄스터</span>-->
<!--                    <span class="tag">#초보</span>-->
<!--                    <span class="tag">#소동물</span>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 채팅방 4 &ndash;&gt;-->
<!--        <div class="chatroom-item" onclick="alert('채팅방에 입장합니다!')">-->
<!--            <img src="https://images.unsplash.com/photo-1520763185298-1b434c919102?w=300&h=300&fit=crop" class="chatroom-thumbnail" alt="반려동물">-->
<!--            <div class="chatroom-info">-->
<!--                <div class="chatroom-title">-->
<!--                    부산 반려동물 병원 정보 공유-->
<!--                </div>-->
<!--                <div class="chatroom-description">-->
<!--                    부산 지역 동물병원 추천, 후기, 가격 정보 등을 공유하는 방입니다.-->
<!--                </div>-->
<!--                <div class="chatroom-meta">-->
<!--                        <span class="chatroom-members">-->
<!--                            <i class="fas fa-user"></i>-->
<!--                            445명-->
<!--                        </span>-->
<!--                    <span>-->
<!--                            <i class="fas fa-map-marker-alt"></i>-->
<!--                            부산-->
<!--                        </span>-->
<!--                </div>-->
<!--                <div class="chatroom-tags">-->
<!--                    <span class="tag">#부산</span>-->
<!--                    <span class="tag">#병원</span>-->
<!--                    <span class="tag">#정보</span>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 채팅방 5 &ndash;&gt;-->
<!--        <div class="chatroom-item" onclick="alert('채팅방에 입장합니다!')">-->
<!--            <img src="https://images.unsplash.com/photo-1583337130417-3346a1be7dee?w=300&h=300&fit=crop" class="chatroom-thumbnail" alt="강아지">-->
<!--            <div class="chatroom-info">-->
<!--                <div class="chatroom-title">-->
<!--                    골든리트리버 사랑방-->
<!--                </div>-->
<!--                <div class="chatroom-description">-->
<!--                    골든리트리버만의 특별한 매력을 나누는 공간입니다. 훈련법, 건강관리 등 정보 공유해요!-->
<!--                </div>-->
<!--                <div class="chatroom-meta">-->
<!--                        <span class="chatroom-members">-->
<!--                            <i class="fas fa-user"></i>-->
<!--                            678名-->
<!--                        </span>-->
<!--                    <span>-->
<!--                            <i class="fas fa-heart"></i>-->
<!--                            견종별-->
<!--                        </span>-->
<!--                </div>-->
<!--                <div class="chatroom-tags">-->
<!--                    <span class="tag">#골든리트리버</span>-->
<!--                    <span class="tag">#대형견</span>-->
<!--                    <span class="tag">#훈련</span>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 채팅방 6 &ndash;&gt;-->
<!--        <div class="chatroom-item" onclick="alert('채팅방에 입장합니다!')">-->
<!--            <img src="https://images.unsplash.com/photo-1495360010541-f48722b34f7d?w=300&h=300&fit=crop" class="chatroom-thumbnail" alt="앵무새">-->
<!--            <div class="chatroom-info">-->
<!--                <div class="chatroom-title">-->
<!--                    앵무새 키우기-->
<!--                </div>-->
<!--                <div class="chatroom-description">-->
<!--                    앵무새 사육에 대한 모든 것! 먹이, 훈련, 건강관리 등을 함께 이야기해요.-->
<!--                </div>-->
<!--                <div class="chatroom-meta">-->
<!--                        <span class="chatroom-members">-->
<!--                            <i class="fas fa-user"></i>-->
<!--                            234명-->
<!--                        </span>-->
<!--                    <span>-->
<!--                            <i class="fas fa-feather"></i>-->
<!--                            조류-->
<!--                        </span>-->
<!--                </div>-->
<!--                <div class="chatroom-tags">-->
<!--                    <span class="tag">#앵무새</span>-->
<!--                    <span class="tag">#조류</span>-->
<!--                    <span class="tag">#사육정보</span>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 채팅방 7 &ndash;&gt;-->
<!--        <div class="chatroom-item" onclick="alert('채팅방에 입장합니다!')">-->
<!--            <img src="https://images.unsplash.com/photo-1415369629372-26f2fe60c467?w=300&h=300&fit=crop" class="chatroom-thumbnail" alt="열대어">-->
<!--            <div class="chatroom-info">-->
<!--                <div class="chatroom-title">-->
<!--                    아쿠아리움 애호가 모임-->
<!--                    <span class="chatroom-badge">인기</span>-->
<!--                </div>-->
<!--                <div class="chatroom-description">-->
<!--                    수조 세팅, 물고기 종류, 수질 관리 등 아쿠아리움의 모든 것을 함께 나눠요!-->
<!--                </div>-->
<!--                <div class="chatroom-meta">-->
<!--                        <span class="chatroom-members popular">-->
<!--                            <i class="fas fa-user"></i>-->
<!--                            923명-->
<!--                        </span>-->
<!--                    <span>-->
<!--                            <i class="fas fa-fish"></i>-->
<!--                            어류-->
<!--                        </span>-->
<!--                </div>-->
<!--                <div class="chatroom-tags">-->
<!--                    <span class="tag">#아쿠아리움</span>-->
<!--                    <span class="tag">#열대어</span>-->
<!--                    <span class="tag">#수조</span>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; 채팅방 8 &ndash;&gt;-->
<!--        <div class="chatroom-item" onclick="alert('채팅방에 입장합니다!')">-->
<!--            <img src="https://images.unsplash.com/photo-1612363148260-0d00f82d8b4f?w=300&h=300&fit=crop" class="chatroom-thumbnail" alt="도마뱀">-->
<!--            <div class="chatroom-info">-->
<!--                <div class="chatroom-title">-->
<!--                    파충류 마니아-->
<!--                </div>-->
<!--                <div class="chatroom-description">-->
<!--                    뱀, 도마뱀, 거북이 등 파충류를 키우는 분들의 전문 정보 공유방입니다.-->
<!--                </div>-->
<!--                <div class="chatroom-meta">-->
<!--                        <span class="chatroom-members">-->
<!--                            <i class="fas fa-user"></i>-->
<!--                            167명-->
<!--                        </span>-->
<!--                    <span>-->
<!--                            <i class="fas fa-dragon"></i>-->
<!--                            파충류-->
<!--                        </span>-->
<!--                </div>-->
<!--                <div class="chatroom-tags">-->
<!--                    <span class="tag">#파충류</span>-->
<!--                    <span class="tag">#도마뱀</span>-->
<!--                    <span class="tag">#특수동물</span>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

    </div>
</div>

<button class="fab" onclick="alert('새 채팅방 만들기 기능은 개발 중입니다!')">
    <i class="fas fa-plus"></i>
</button>

<script>
    // 카테고리 필터 기능
    document.querySelectorAll('.category-chip').forEach(chip => {
        chip.addEventListener('click', function() {
            document.querySelectorAll('.category-chip').forEach(c => c.classList.remove('active'));
            this.classList.add('active');

            const category = this.textContent.trim();
            console.log('선택된 카테고리:', category);
            // 여기에 필터링 로직 추가 가능
        });
    });
    const getChatroom = async(btn) => {
        const chatroom = btn.closest('.chatroom-item')
        const roomid = chatroom.getAttribute("data-roomId")

        const response = await fetch("/addChatUserCount", {
            method : "POST",
            headers : {
                'Content-Type' : 'application/json'
            },
            body: JSON.stringify({"roomId": roomid})
        })
        if(response.ok){
            const res = await response.json()
            location.href = `/openchat/${roomid}`
        }
        else{
            console.log("Failed to connecting the server")
        }


    }

    // 검색 기능
    // document.querySelector('.search-btn').addEventListener('click', function() {
    //     const searchText = document.querySelector('.search-input').value;
    //     if (searchText.trim()) {
    //         alert(`"${searchText}" 검색 결과를 표시합니다!`);
    //         // 여기에 검색 로직 추가 가능
    //     }
    // });
    document.getElementById("header-openchat").classList.add("active")
    // 엔터키로 검색
    document.querySelector('.search-input').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            document.querySelector('.search-btn').click();
        }
    });

    // 헤더 네비게이션
    document.querySelectorAll('.header-nav-item').forEach(item => {
        item.addEventListener('click', function() {
            document.querySelectorAll('.header-nav-item').forEach(i => i.classList.remove('active'));
            this.classList.add('active');
        });
    });
</script>
</body>
</html>